# 技术架构图

## 系统整体架构

```
                    ┌─────────────────────────────────────────┐
                    │              用户界面层                  │
                    │  ┌─────────────┐  ┌─────────────────┐   │
                    │  │  Web界面    │  │   飞书机器人     │   │
                    │  └─────────────┘  └─────────────────┘   │
                    └─────────────────────────────────────────┘
                                        │
                    ┌─────────────────────────────────────────┐
                    │              应用服务层                  │
                    │  ┌─────────────┐  ┌─────────────────┐   │
                    │  │  FastAPI    │  │   告警服务       │   │
                    │  │  Web服务    │  │                 │   │
                    │  └─────────────┘  └─────────────────┘   │
                    └─────────────────────────────────────────┘
                                        │
                    ┌─────────────────────────────────────────┐
                    │              业务逻辑层                  │
                    │  ┌─────────────┐  ┌─────────────────┐   │
                    │  │  行为识别    │  │   智能分析       │   │
                    │  │  引擎        │  │   引擎          │   │
                    │  └─────────────┘  └─────────────────┘   │
                    └─────────────────────────────────────────┘
                                        │
                    ┌─────────────────────────────────────────┐
                    │              AI服务层                   │
                    │  ┌─────────────┐  ┌─────────────────┐   │
                    │  │  FastVLM    │  │  AWS Bedrock    │   │
                    │  │  视觉模型    │  │  Claude3        │   │
                    │  └─────────────┘  └─────────────────┘   │
                    └─────────────────────────────────────────┘
                                        │
                    ┌─────────────────────────────────────────┐
                    │              数据层                     │
                    │  ┌─────────────┐  ┌─────────────────┐   │
                    │  │  MySQL      │  │   文件存储       │   │
                    │  │  数据库      │  │   (图片/视频)    │   │
                    │  └─────────────┘  └─────────────────┘   │
                    └─────────────────────────────────────────┘
                                        │
                    ┌─────────────────────────────────────────┐
                    │              硬件层                     │
                    │  ┌─────────────┐  ┌─────────────────┐   │
                    │  │ Windows/Mac │  │  TP-Link摄像头  │   │
                    │  └─────────────┘  └─────────────────┘   │
                    └─────────────────────────────────────────┘
```

## 数据流架构

```
摄像头 → 视频流 → 帧提取 → FastVLM → 行为识别 → 数据存储
                                    ↓
                              异常检测 → AWS Bedrock → 智能分析 → 告警通知
```

## 核心组件说明

### 1. 视频处理模块
- 负责摄像头视频流的获取和处理
- 实现帧提取和预处理
- 支持多种视频格式和分辨率

### 2. AI识别引擎
- FastVLM: 负责视觉识别和行为分类
- AWS Bedrock Claude3: 负责智能分析和决策

### 3. 数据存储模块
- MySQL: 存储结构化数据
- 文件系统: 存储图片和视频文件

### 4. 通知系统
- 飞书机器人API集成
- 支持多种告警级别
- 实时推送异常信息

## 部署架构

### 开发环境
```
开发机 ← 本地开发 → 主机 (开发环境)
```

### 生产环境
```
用户 ← HTTP/WebSocket → 主机 (生产环境) → AWS Bedrock
                                    ↓
                                 飞书API
```
